<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Central Landscaping - Content Manager</title>
    
    <!-- Include the script that enables Netlify Identity on this page. -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    
    <style>
      /* Fix for cursor jumping issue in Chrome */
      div[data-slate-editor] {
        -webkit-user-modify: read-write !important;
      }
      
      /* Make the editor more user-friendly */
      .nc-entryEditor-contentCard {
        padding: 20px !important;
      }
      
      /* Better visual styling for the rich text editor */
      .ProseMirror {
        min-height: 300px !important;
        padding: 16px !important;
      }
      
      /* Required field styling */
      .labelWithError {
        color: #e25e5e !important;
      }
    </style>
  </head>
  <body>
    <!-- Include the script that builds the page and powers Netlify CMS -->
    <script src="https://unpkg.com/netlify-cms@^2.10.192/dist/netlify-cms.js"></script>
    
    <script>
      // Wait for CMS to initialize
      window.addEventListener('load', function() {
        if (window.netlifyIdentity) {
          window.netlifyIdentity.on("init", user => {
            if (!user) {
              window.netlifyIdentity.on("login", () => {
                document.location.href = "/admin/";
              });
            }
          });
        }
        
        // Configure CMS to show all blog posts
        if (window.CMS) {
          // Custom config to detect both .md and .html blog posts
          window.CMS.registerPreviewStyle(`
            .preview-panel { 
              height: 100%; 
              overflow: auto;
            }
            .frame-content {
              height: 100%;
            }
            .frame-content body {
              height: 100%;
              overflow: auto;
              padding: 20px;
              box-sizing: border-box;
            }
            p, h1, h2, h3, h4, h5, h6 {
              margin-bottom: 16px;
            }
          `);
          
          // Show all blog posts regardless of extension
          window.CMS.registerEventListener({
            name: 'preSave',
            handler: function(data) {
              // Make sure the blog post gets saved with the correct format
              return data;
            }
          });
        }
        
        // Simple helper to improve editor experience
        setTimeout(function() {
          // Make the "required" text more noticeable
          const requiredLabels = document.querySelectorAll('[class*="FieldLabel-required"]');
          if (requiredLabels) {
            requiredLabels.forEach(label => {
              label.style.color = '#e25e5e';
              label.style.fontWeight = 'bold';
            });
          }
          
          // Add helper text above the body editor
          const bodyField = document.querySelector('[id*="editor-body-"]');
          if (bodyField) {
            const helpText = document.createElement('div');
            helpText.style.padding = '8px';
            helpText.style.marginBottom = '10px';
            helpText.style.backgroundColor = '#f8f9fa';
            helpText.style.borderLeft = '4px solid #4a8553';
            helpText.style.color = '#333';
            helpText.style.fontSize = '14px';
            helpText.innerHTML = '✏️ Use the toolbar to format your text. This field is required.';
            
            if (bodyField.parentNode) {
              bodyField.parentNode.insertBefore(helpText, bodyField);
            }
          }
          
          // Add blog instructions
          const blogInstructions = document.createElement('div');
          blogInstructions.style.padding = '15px';
          blogInstructions.style.margin = '20px 0';
          blogInstructions.style.backgroundColor = '#f0f7f1';
          blogInstructions.style.borderRadius = '5px';
          blogInstructions.style.color = '#333';
          blogInstructions.style.fontSize = '14px';
          blogInstructions.innerHTML = `
            <h3 style="margin-top: 0; color: #4a8553; font-weight: bold;">Blog Instructions</h3>
            <p>When you publish a blog post:</p>
            <ol style="margin-left: 20px;">
              <li>Fill out all required fields (Title, Publish Date, Featured Image, Description, Body)</li>
              <li>Use the formatting toolbar to style your content</li>
              <li>Click "Save" to save your draft</li>
              <li>Click "Publish" when ready to make the post live</li>
              <li>It will appear on the blog page automatically</li>
            </ol>
          `;
          
          const mainContainer = document.querySelector('.css-1f7kkg-ControlContainer');
          if (mainContainer) {
            mainContainer.parentNode.insertBefore(blogInstructions, mainContainer);
          }
        }, 1000);
      });
    </script>
  </body>
</html> 